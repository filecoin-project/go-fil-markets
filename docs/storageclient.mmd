stateDiagram-v2
	state "StorageDealUnknown" as 0
	state "StorageDealProposalAccepted" as 3
	state "StorageDealSealing" as 5
	state "StorageDealActive" as 7
	state "StorageDealExpired" as 8
	state "StorageDealSlashed" as 9
	state "StorageDealFailing" as 11
	state "StorageDealFundsEnsured" as 12
	state "StorageDealCheckForAcceptance" as 13
	state "StorageDealStartDataTransfer" as 16
	state "StorageDealTransferring" as 17
	state "StorageDealClientTransferRestarted" as 18
	state "StorageDealEnsureClientFunds" as 22
	state "StorageDealClientFunding" as 24
	state "StorageDealError" as 27
	3 : On entry runs ValidateDealPublished
	5 : On entry runs VerifyDealActivated
	7 : On entry runs WaitForDealCompletion
	11 : On entry runs FailDeal
	12 : On entry runs ProposeDeal
	13 : On entry runs CheckForDealAcceptance
	16 : On entry runs InitiateDataTransfer
	18 : On entry runs RestartDataTransfer
	22 : On entry runs EnsureClientFunds
	24 : On entry runs WaitForFunding
	[*] --> 0
	note right of 0
		The following events are not shown cause they can trigger from any state.

		ClientEventStreamCloseError - transitions state to StorageDealError
		ClientEventRestart - does not transition state
	end note
	0 --> 22 : ClientEventOpen
	22 --> 24 : ClientEventFundingInitiated
	22 --> 11 : ClientEventEnsureFundsFailed
	24 --> 11 : ClientEventEnsureFundsFailed
	22 --> 12 : ClientEventFundsEnsured
	24 --> 12 : ClientEventFundsEnsured
	12 --> 27 : ClientEventWriteProposalFailed
	12 --> 11 : ClientEventReadResponseFailed
	12 --> 11 : ClientEventResponseVerificationFailed
	12 --> 16 : ClientEventInitiateDataTransfer
	12 --> 11 : ClientEventUnexpectedDealState
	16 --> 11 : ClientEventDataTransferFailed
	17 --> 11 : ClientEventDataTransferFailed
	18 --> 11 : <invalid Value>
	16 --> 17 : ClientEventDataTransferInitiated
	18 --> 17 : ClientEventDataTransferInitiated
	18 --> 17 : ClientEventDataTransferRestarted
	16 --> 13 : ClientEventDataTransferComplete
	17 --> 13 : ClientEventDataTransferComplete
	13 --> 13 : ClientEventWaitForDealState
	13 --> 11 : ClientEventResponseDealDidNotMatch
	13 --> 11 : ClientEventDealRejected
	13 --> 3 : ClientEventDealAccepted
	3 --> 27 : ClientEventDealPublishFailed
	3 --> 5 : ClientEventDealPublished
	5 --> 27 : ClientEventDealActivationFailed
	5 --> 7 : ClientEventDealActivated
	7 --> 9 : ClientEventDealSlashed
	7 --> 8 : ClientEventDealExpired
	7 --> 27 : ClientEventDealCompletionFailed
	11 --> 27 : ClientEventFailed
	17 --> 18 : ClientEventRestart

	note left of 3 : The following events only record in this state.<br><br>ClientEventFundsReleased


	note left of 11 : The following events only record in this state.<br><br>ClientEventFundsReleased


	note left of 22 : The following events only record in this state.<br><br>ClientEventFundsReserved

	9 --> [*]
	8 --> [*]
	27 --> [*]
